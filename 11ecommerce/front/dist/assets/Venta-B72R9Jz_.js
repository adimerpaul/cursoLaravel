import{_ as b,c as n,a as t,g,F as c,r as p,w as C,t as d,b as v,e as h,o as a,f as k,v as f}from"./index-DIYoO28f.js";const x={name:"VentaPage",data(){return{productos:[],carrito:[],clientes:[],selectedCliente:null}},mounted(){this.fetchProductos(),this.fetchClientes()},methods:{fetchClientes(){const r=localStorage.getItem("token");h.get("http://localhost:8000/api/clientes",{headers:{Authorization:`Bearer ${r}`}}).then(e=>{this.clientes=e.data}).catch(e=>{console.error("Error al cargar clientes:",e)})},fetchProductos(){const r=localStorage.getItem("token");h.get("http://localhost:8000/api/productos?limit=100&page=1&search=",{headers:{Authorization:`Bearer ${r}`}}).then(e=>{this.productos=e.data.data}).catch(e=>{console.error("Error al cargar productos:",e)})},agregarAlCarrito(r){let e={...r};e.cantidad=1,this.carrito.push(e)},eliminarDelCarrito(r){this.carrito.splice(r,1)},realizarVenta(){if(this.carrito.length===0){alert("El carrito está vacío.");return}if(!this.selectedCliente){alert("Por favor, selecciona un cliente.");return}const r=localStorage.getItem("token"),e={items:this.carrito.map(o=>({producto_id:o.id,cantidad:o.cantidad,precio_unitario:o.precio_venta_actual})),cliente_id:this.selectedCliente};h.post("http://localhost:8000/api/ventas",e,{headers:{Authorization:`Bearer ${r}`}}).then(o=>{alert("Venta realizada con éxito."),this.carrito=[],this.selectedCliente=null}).catch(o=>{console.error("Error al realizar la venta:",o),alert("Error al realizar la venta.")})}}},V=["src"],y=["onClick"],_=["onUpdate:modelValue"],z=["onClick"],w={colspan:"4",style:{"text-align":"right","font-weight":"bold"}},A=["value"];function E(r,e,o,P,i,u){return a(),n(c,null,[e[7]||(e[7]=t("h1",null,"Ventas",-1)),e[8]||(e[8]=t("p",null,"Aquí puedes gestionar las ventas.",-1)),t("table",null,[t("tr",null,[t("td",null,[e[3]||(e[3]=g(" Productos Disponibles ",-1)),t("table",null,[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",null,"Nombre"),t("th",null,"Precio"),t("th",null,"Imagen"),t("th",null,"Opciones")])],-1)),t("tbody",null,[(a(!0),n(c,null,p(i.productos,l=>(a(),n("tr",{key:l.id},[t("td",null,d(l.nombre),1),t("td",null,d(l.precio_venta_actual),1),t("td",null,[l.imagen?(a(),n("img",{key:0,src:`http://localhost:8000/imagenes/${l.imagen}`,alt:"Imagen del producto",style:{"max-width":"45px","max-height":"45px"}},null,8,V)):k("",!0)]),t("td",null,[t("button",{onClick:s=>u.agregarAlCarrito(l)},"Agregar al Carrito",8,y)])]))),128))])])]),t("td",null,[e[5]||(e[5]=g(" Carrito de Compras ",-1)),t("table",null,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"Nombre"),t("th",null,"Precio"),t("th",null,"Cantidad"),t("th",null,"Opciones")])],-1)),t("tbody",null,[(a(!0),n(c,null,p(i.carrito,(l,s)=>(a(),n("tr",{key:s},[t("td",null,d(l.nombre),1),t("td",null,d(l.precio_venta_actual),1),t("td",null,[C(t("input",{type:"number","onUpdate:modelValue":m=>l.cantidad=m,min:"1",style:{width:"50px"}},null,8,_),[[f,l.cantidad,void 0,{number:!0}]])]),t("td",null,[t("button",{onClick:m=>u.eliminarDelCarrito(s)},"Eliminar",8,z)])]))),128)),t("tr",null,[t("td",w," Total: "+d(i.carrito.reduce((l,s)=>l+s.precio_venta_actual*s.cantidad,0)),1)])])]),e[6]||(e[6]=t("label",{for:"cliente"},"Seleccionar Cliente:",-1)),C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>i.selectedCliente=l),id:"cliente",style:{"margin-top":"0.5rem",padding:"0.5rem",border:"1px solid #ccc","border-radius":"4px",width:"100%"}},[(a(!0),n(c,null,p(i.clientes,l=>(a(),n("option",{key:l.id,value:l.id},d(l.razon_social),9,A))),128))],512),[[v,i.selectedCliente]]),t("button",{onClick:e[1]||(e[1]=(...l)=>u.realizarVenta&&u.realizarVenta(...l)),style:{"margin-top":"1rem",padding:"0.5rem 1rem","background-color":"#4CAF50",color:"white",border:"none","border-radius":"4px",cursor:"pointer"}}," Realizar Venta ")])])]),e[9]||(e[9]=t("pre",null,`        
        
    `,-1))],64)}const D=b(x,[["render",E]]);export{D as default};
