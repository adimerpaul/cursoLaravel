import{_ as b,c as n,a as e,g,F as c,r as p,w as C,t as d,b as v,e as h,o as a,f as k,v as f}from"./index-BI2CHZ53.js";const x={name:"VentaPage",data(){return{productos:[],carrito:[],clientes:[],selectedCliente:null}},mounted(){this.fetchProductos(),this.fetchClientes()},methods:{fetchClientes(){const l=localStorage.getItem("token");h.get("http://143.198.70.37:8000/api/clientes",{headers:{Authorization:`Bearer ${l}`}}).then(t=>{this.clientes=t.data}).catch(t=>{console.error("Error al cargar clientes:",t)})},fetchProductos(){const l=localStorage.getItem("token");h.get("http://143.198.70.37:8000/api/productos?limit=100&page=1&search=",{headers:{Authorization:`Bearer ${l}`}}).then(t=>{this.productos=t.data.data}).catch(t=>{console.error("Error al cargar productos:",t)})},agregarAlCarrito(l){let t={...l};t.cantidad=1,this.carrito.push(t)},eliminarDelCarrito(l){this.carrito.splice(l,1)},realizarVenta(){if(this.carrito.length===0){alert("El carrito está vacío.");return}if(!this.selectedCliente){alert("Por favor, selecciona un cliente.");return}const l=localStorage.getItem("token"),t={items:this.carrito.map(o=>({producto_id:o.id,cantidad:o.cantidad,precio_unitario:o.precio_venta_actual})),cliente_id:this.selectedCliente};h.post("http://143.198.70.37:8000/api/ventas",t,{headers:{Authorization:`Bearer ${l}`}}).then(o=>{alert("Venta realizada con éxito."),this.carrito=[],this.selectedCliente=null}).catch(o=>{console.error("Error al realizar la venta:",o),alert("Error al realizar la venta.")})}}},V=["src"],y=["onClick"],_=["onUpdate:modelValue"],z=["onClick"],w={colspan:"4",style:{"text-align":"right","font-weight":"bold"}},A=["value"];function E(l,t,o,P,i,u){return a(),n(c,null,[t[7]||(t[7]=e("h1",null,"Ventas",-1)),t[8]||(t[8]=e("p",null,"Aquí puedes gestionar las ventas.",-1)),e("table",null,[e("tr",null,[e("td",null,[t[3]||(t[3]=g(" Productos Disponibles ",-1)),e("table",null,[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Imagen"),e("th",null,"Opciones")])],-1)),e("tbody",null,[(a(!0),n(c,null,p(i.productos,r=>(a(),n("tr",{key:r.id},[e("td",null,d(r.nombre),1),e("td",null,d(r.precio_venta_actual),1),e("td",null,[r.imagen?(a(),n("img",{key:0,src:`http://143.198.70.37:8000/imagenes/${r.imagen}`,alt:"Imagen del producto",style:{"max-width":"45px","max-height":"45px"}},null,8,V)):k("",!0)]),e("td",null,[e("button",{onClick:s=>u.agregarAlCarrito(r)},"Agregar al Carrito",8,y)])]))),128))])])]),e("td",null,[t[5]||(t[5]=g(" Carrito de Compras ",-1)),e("table",null,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Opciones")])],-1)),e("tbody",null,[(a(!0),n(c,null,p(i.carrito,(r,s)=>(a(),n("tr",{key:s},[e("td",null,d(r.nombre),1),e("td",null,d(r.precio_venta_actual),1),e("td",null,[C(e("input",{type:"number","onUpdate:modelValue":m=>r.cantidad=m,min:"1",style:{width:"50px"}},null,8,_),[[f,r.cantidad,void 0,{number:!0}]])]),e("td",null,[e("button",{onClick:m=>u.eliminarDelCarrito(s)},"Eliminar",8,z)])]))),128)),e("tr",null,[e("td",w," Total: "+d(i.carrito.reduce((r,s)=>r+s.precio_venta_actual*s.cantidad,0)),1)])])]),t[6]||(t[6]=e("label",{for:"cliente"},"Seleccionar Cliente:",-1)),C(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>i.selectedCliente=r),id:"cliente",style:{"margin-top":"0.5rem",padding:"0.5rem",border:"1px solid #ccc","border-radius":"4px",width:"100%"}},[(a(!0),n(c,null,p(i.clientes,r=>(a(),n("option",{key:r.id,value:r.id},d(r.razon_social),9,A))),128))],512),[[v,i.selectedCliente]]),e("button",{onClick:t[1]||(t[1]=(...r)=>u.realizarVenta&&u.realizarVenta(...r)),style:{"margin-top":"1rem",padding:"0.5rem 1rem","background-color":"#4CAF50",color:"white",border:"none","border-radius":"4px",cursor:"pointer"}}," Realizar Venta ")])])]),t[9]||(t[9]=e("pre",null,`        
        
    `,-1))],64)}const D=b(x,[["render",E]]);export{D as default};
